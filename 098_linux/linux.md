# Linux基础

## 一.目录结构

1. 根目录下
   + bin  二进制可执行文件
   + boot  存放系统引导时使用的各种文件
   + dev  用于存放设备文件
   + **etc**  存放系统配置文件
   + **home**  存放所有用户文件的根目录
   + lib  存放跟文件系统中的程序运行所需要的共享库及内核模块
   + mnt  系统管理员安装临时文件系统的安装点
   + opt  额外安装的可选应用程序包所放置的位置
   + proc  虚拟文件系统，存放当前内存的映射
   + root  超级用户目录
   + sbin  存放二进制可执行文件，只有root才能访问
   + tmp  用于存放各种临时文件
   + **usr**  用于存放系统应用程序，比较重要的目录/usr/local 本地管理员软件安装目录
     + /usr/local  自己安装的程序
   + **var**  用于存放运行时需要改变数据的文件

## 二.概述

1. 键
   + tab : 用于补全
   + ctrl + c :  中止程序
   + ctrl + d :  退出，相当于quit
2. 帮助命令
   + man    //  查询命令或文件的相关用法
   + man date

## 三.命令

### 1.文件与目录操作

1. ls
   + 显示文件和目录列表
   + ls [options...] [fileFoldName...]
     + -l 列出文件的详细信息
     + -a 列出当前目录所有文件，包含隐藏文件
2. mkdir
   + 创建目录
   + mkdir [-p] dirName
     + -p  父目录不存在情况下先生成父目录，例如 `mkdir -P ./test/child`
3. rmdir
   + 删除目录
   + rmdir dirname
4. cd
   + 切换目录
   + cd dirName
5. touch
   + 生成一个空文件
6. echo
   + 生成一个带内容文件
   + echo content > fileName  创建并写入内容到指定文件
   + echo content >> fileName  将内容追加到指定文件，若文件不存在会自动创建
7. cp
   + 复制文件或目录
   + cp [options] source dest
8. rm
   + 删除文件
   + rm [options] name
     + -f  强制删除文件或目录
     + -r  删除该目录下的所有文件，递归删除
9. mv
   + 移动文件或目录，也可以用来重命名
   + mv [options...] source dest
10. find
    + 在文件系统中查找指定的文件
    + find -name 'fileName'
11. grep
    + 在指定文本文件中查找指定的字符串
12. tree
    + 以树状图列出目录的内容
13. pwd
    + 显示当前目录的完整路径
14. ln
    + 建立软链接
15. 文件隐藏属性
    + chattr  //此命令只能在Ext2/Ext3文件系统上生效
      + chattr +i fileName   // 给文件加i属性表示此文件不能被删除和改名
      + chattr -i fileName    // 去除i属性
      + chatrr +a fileName  // a属性表示这个文件只能增加数据，不能修改和删除数据
      + chatrr -a fileName
    + lsattr  // 查看文件有哪些隐藏属性

### 2.文件与命令查询

1. which  // 查找命令文件所在位置，根据环境变量$path设置的目录查找符合条件的文件

   + `which ifconfig`   // 查询ifconfig命令位置
   + `which -a ifconfig`   // -a查询所有

2. whereis  // 查找源代码，二进制文件，帮助文件位置

   + whereis ifconfig

3. locate    // 查找符合条件的文档，文件的目录也可以当作检索条件，locate查询的是文件和目录数据库，1天1更有时效性

   + locate 关键字   // 不能使用通配符

4. find    // 查找指定目录下文件，扫描磁盘速度慢

   + 非管理员账户通过 sudo 执行，否则会遇到权限问题

   + find /home -name "fileName"    // 查找home目录下指定文件 
   + find / -name "fileNa*"     // 结合通配符查找时一定要加上引号，否则查找结果不全
   + find -name "fileNa*"     // 不加路径参数时，默认查找当前目录下文件

### 3.文件内容查阅

1. cat  // 由第一行内容开始查阅
   + cat leo.txt
   + cat -n leo.txt   // 列出行号
2. tac  // 倒序查阅，cat的反写
3. zcat  // 不解压文件显示文件内容
4. more  // 分页显示
   + more leo.txt
     + 空格键：向下翻页
     + b：往回翻页，只对文件有效，对管道无效、
     + enter：向下滚动一行
     + /关键字：在当前显示的内容中，向下查询关键字，按n可查看一个个查找值
     + :f  : 显示当前行数
     + q：退出
5. less  // 分页显示
   + less leo.txt
     + 空格键：向下翻页
     + PageDown：向下翻页
     + PageUp：向上翻页
     + /关键字：查询
     + n：重复前一个查询
     + N：反向重复前一个查询
     + q：退出
6. head  // 在头部抽取数据显示
   + head leo.txt  // 默认显示前10行
   + head -n 20 leo.txt  // 显示前20行
   + head -n -100 leo.txt  // 假设leo.txt有151行，则此命令意思为显示前51行，可以认为是151-100
7. tail  // 在尾部抽取数据显示
   + tail -n 20 leo.txt  // 显示后20行
   + tail -f leo.txt   // 持续显示尾部内容
   + tail -200f leo.txt  // 持续显示后200行内容
   + head -n 20 leo.txt | tail -n 10    // 显示第11行到20行内容

### 3.文件系统管理

1. 磁盘与目录容量
   + df  // 列出文件系统的整体磁盘使用量，显示的是整个磁盘的信息
     + df -h  // 以GB,MB,KB等格式自行显示，最常用，不加路径表示当前目录目录所在磁盘，加路径表示目录所在磁盘
   + du  // 评估目录所占容量
     + du -sh   // 以易读方式列出当前目录容量
     + du -sh /mysoft/*    // 以易读方式列出mysoft目录下所有文件和目录的大小
     + -s  ：列出总量
2. 连接文件：ln
3. 磁盘分区、挂载与卸载

### 3.系统管理命令

1. stat
   + 显示指定文件的相关信息,比ls命令显示内容更多
2. who
   + 显示当前在线登陆用户
3. hostname
   + 显示主机名称
4. uname
   + 显示系统信息
5. top
   + 显示当前系统中耗费资源最多的进程
6. ps
   + 显示瞬间的进程状态
   + ps -ef
7. free
   + 显示当前内存和交换空间的使用情况
8. ifconfig
   + 显示网络接口信息
9. ping
   + 测试网络是否通畅
10. netstat
    + 显示网络状态
11. clear
    + 清屏
12. kill
    + 杀死一个进程
    + kill [options...] pid
    + kill -9 pid

### 3.开关机命令

1. stutdown
   + 关机
   + stutdown -h now 现在立即关机
   + stutdown -r  now 现在立即重启
2. reboot
   + 重启

### 4.压缩命令

1. tar
   + tar [-cxzjvf] 压缩打包文档名称 欲打包目录
     + -c  建立归档文件
     + -x  解开归档文件
     + -z  是否需要使用gzip压缩
     + -j  是否需要使用bzip2压缩
     + -v  压缩过程中显示文件
     + -f  使用档名
     + -tf  查看归档文件里面的文件
   + tar -zcvf test.tar.gz test\   压缩test文件夹
   + tar -zxvf test.tar.gz  解压文件夹
2. gzip
   + 可以解开zip，gzip等软件的压缩文件
   + gzip [选项] 文件名
     + -d  解压文件
     + -l  显示压缩的相关信息
     + -v  显示文件名和压缩比
3. bzip2
   + 压缩文件后缀为bz2
   + bzip2 [-cdz]
     + -d  解压文件
     + -z  压缩文件

## 三.用户和组

### 1.组账户

+ 私有组
  + 当创建一个用户时没有指定属于哪个组时，Linux会创建一个与用户同名的私有组，改组只包含该用户
+ 标准组
  + 当创建一个用户时选择一个标准组，所一个用户同时属于多个组，则登陆后的组为主组，其余为附加组

### 2.账户系统

1. /etc/passwd
   + 每一行代表一个账号
   + `root:x:0:0:root:/root:/bin/bash`
     + 账号名
     + 口令，现在以x代替
     + UID：root用户UID为0
     + GID：与/etc/group相对应
     + 注释
     + 账户文件夹
     + shell类型
2. /etc/shadow
   + 密码相关信息
3. /etc/group
   + 用户组配置文件
   + `root:x:0:dev`
     + 用户组名称
     + 密码
     + GID
     + 此用户组包含的账户
4. /etc/gshadow
   + 定义用户组口令

### 3.常用命令

1. useradd
   + 新增用户
   + **useradd username**
     + -u :  UID
     + **-p** :  口令
     + **-g** :  分组
     + -s :  shell
     + -d :  用户目录
2. userdel
   + 删除用户
   + userdel username
     + -r  ：删除账号时同时删除目录
3. 口令维护
   + **passwd 用户账户名**  // 设置用户口令
   + passwd -l 用户账户名  // 锁定用户账户
   + passwd -u 用户账户名  // 解锁用户账户
   + passwd -d 用户账户名  // 删除账户口令
   + **gpasswd -a 用户账户名 组账户名**   // 将指定用户添加到指定组
   + **gpasswd -d 用户账户名 组账户名**   // 将用户从指定组中删除
   + gpasswd -A 用户账户名 组账户名   // 将用户指定为组的管理员
4. 组账号维护
   + groupadd  组账户名    // 创建新组
     + -g  :  指定组GID
   + groupmod
     + 修改组
     + -g ：修改组GID
     + -n :  修改组账户名
   + groupdel
     + groupdel 组账号名  // 删除指定组账号
5. 用户和组状态
   + **su 用户名**  // 切换用户账户
   + id  用户名  // 显示用户的UID，GID
   + whoami   //  显示当前用户名称
   + **groups**   // 显示用户所属组

## 四.文件权限管理

1. 查看文件和目录权限
   + ls -l
   + 显示信息 ：`drwxr-xr-x 10 root root     4096 Jun 16 17:56 NeteaseCloudMusicApi-master`
     + 文件类型，文件权限，文件所属用户，文件所属组，文件的大小，文件的创建时间，文件的名称
       + 文件类型：d 表示目录，l 表示软链接，- 表示文件
       + 文件权限三个字符为一组，r 只读，w 可写，x 可执行，- 表示无此权限，第一组为当前用户权限，第二组为用户组权限，第三组为其他用户权限
       + 连接数，指有多少个文件指向同一个索引节点
2. chown  : 更改文件所有者 chang owner
   + 更改文件所属用户及所属组
     + chown -R 用户名称 文件或者目录    // 更改文件所属用户，-R 为递归更改，表示将目录下所有文件及文件夹进行变更
       + `chown -R superleo foldName`  
     + chown -R 用户名称:用户组名称 文件或目录  // 更改用户及用户组
       + `chown -R superleo:leo foldNameq`
3. chgrp :  改变文件所属组
   + chgrp leo test.log     // 将test.log文件添加到leo组
   + chgrp -R leo test       //  递归遍历test文件夹并将其添加到leo组 n
4. chmod ：更改文件权限
   + chmod [who] [ + 或者 - 或者 =] [mode] 文件名
     + who 表示操作对象，可以是下面的一个或者组合
       + u : 用户user
       + g : 用户组group
       + o : 表示其他用户
       + a : 表示所有用户
     + 操作符号
       + `+` : 表示添加某个权限
       + `-` : 表示取消某个权限
       + `=` : 表示赋予给定权限，取消文档以前的所有权限
     + mode 表示权限
       + r
       + w
       + x
     + 文件名可以用空格分开
     + 例子 `chmod u=rwx,g+r,o+r test.txt`  给当前用户添加可读可写可执行权限，给组用户和其他用户添加可读权限
   + 数字设定法
     + 用数字表示权限，0表示没有任何权限，1表示有可执行权限，2表示有可写权限，4表示有可读权限
     + 若要 `rwx` 则需要4+2+1=7，若要`rw-`则需要6，若要`r-x`则需要5...
     + 例子：`chmod 755 fileName`  表示给当前用户可读可写可执行权限，给组用户和其他用户添加可读可执行权限

## 五.软件包管理

### 1.yum

### 2.apt

1. 修改源
   + vim /etc/apt/source.list
   + apt-get update  // 更新数据源
2. 常用命令
   + **apt-get install packageName**  // 安装
   + **apt-get remove packageName**  // 卸载
   + **apt-get remove package --purge**  // 删除包及配置文件
   + apt-get update  // 更新软件包
   + apt-get build-dep package   // 安装相关的编译环境
   + apt-get source package  // 下载源代码
   + apt-get clean && apt-get autoclean  // 清除无用的包
   + apt-get check  // 检查
   + **apt-cache search packageName**  // 搜索包
   + **apt-cache show package**  // 获取包信息
   + apt-cache depends package  // 查看包依赖
   + apt-cache rdepends package  //  查看被哪些包依赖

## 五.编辑器

### 1.vim

1. 运行模式

   + 普通模式：可以使用上下左右按键移动光标，可以删除字符和删除整行，也可以复制粘贴数据，但不能编辑
   + 编辑模式：普通模式下，按`i,I,o,O,a,A,R`进入编辑模式，按esc退出编辑模式回到普通模式
   + 命令模式：普通模式下，按`:,/,?`进入命令模式，在此模式下，可以对数据进行查找、读取、保存、替换操作，也可以离开vim，显示行号等，按esc退出命令模式回到普通模式

2. 命令（命令模式下）

   + 普通模式切换到编辑模式
     + i ：进入插入模式，从目前光标所在处插入
     + I ：进入插入模式，从目前光标所在行第一个非空格符处开始插入
     + a ：进入插入模式，从目前光标所在处的下一个字符开始插入
     + A ：进入插入模式，从光标所在行的最后一个字符处开始插入
     + o ：进入插入模式，在当前光标所在行的下一行插入新行
     + O ：进入插入模式，在当前光标所在行的上一行插入新行
     + r ：进入替换模式，r只会替换光标所在那个字符一次
     + R ：进入替换模式，R会一直替换光标所在字符，直到按esc键退出
     + esc键 ：退出编辑模式回到普通模式

   + 普通模式

     + ------------------------------------------------------- 光标移动 ---------------------------------------------------------------

     + h 或 左箭头 ：光标左移    // 20h 可以直接向左移动20个字符，箭头键也同理
     + l 或右箭头 ：光标右移
     + j 或上箭头：光标上移
     + k 或下箭头 ：光标下移
     + ctrl + f ：相当于pagedown
     + ctrl + b ：相当于pageup
     + num + space ：先按数字，在按空格键，光标会移动num个字符
     + 0 / home键 ：光标移动到行首
     + $ / end键 ：光标移动到行尾
     + H ：光标移动到屏幕首字符
     + L ：光标移动到屏幕最下方行首
     + G ：光标移动到文件最后一行
     + num + G ：光标移动到这个的第n行
     + gg ：光标移动到这个文件第一行，相当于1G
     + num + enter键 ：向下移动num行
     + ----------------------------------------------------------删除----------------------------------------------------------
     + x ：小写，向后删除一个字符
     + X ：大写，向前删除一个字符
     + num + x ：连续向后删除num个字符
     + dd ：删除光标所在行
     + num + dd ：删除光标所在的向下num行
     + d1G ：删除光标所在行到第一行的所有数据，包括光标所在行
     + dG ：删除光标所在行到最后一行的所有数据，包括光标所在行
     + d$ ：删除从光标所在位置到该行的最后一个字符
     + d0 ：删除光标所在位置到该行最前面一个字符
     + ----------------------------------------------------------复制------------------------------------------------------------
     + yy ：复制光标所在行
     + num + yy ：复制光标所在行的向下num行
     + y1G ：复制光标所在行到第一行的所有数据
     + yG ：复制光标所在行到最后一行的所有数据
     + y0 ：复制光标所在位置到该行行首所有数据
     + y$ ：复制光标所在位置到该行行尾所有数据
     + ---------------------------------------------------------粘贴---------------------------------------------------------------
     + p ：小写，将数据粘贴在光标下一行
     + P ：大写，将数据粘贴在光标上一行
     + ----------------------------------------------------------杂------------------------------------------------------------------
     + J ：将光标所在行与下一行的数据结合成一行
     + u ：撤销上一个操作
     + . ：重复前一个操作

   + 命令模式

     + ----------------------------------------------------------查找---------------------------------------------------------------
     + /word ：向下查找
     + ?word ：向上查找
     + n ：进行上一个查找操作
     + N ：反向进行上一个查找操作
     + ----------------------------------------------------------替换---------------------------------------------------------------
     + :num1,num2s/word1/word2/g ：在第num1行和num2行之间寻找word1字符串，并替换为word2
     + :1,$s/word1/word2/g ：从第一行到最后一行查找word1，然后替换为word2
     + :1,$s/word1/word2/gc ：从第一行到最后一行查找word1，然后替换为word2，并在替换前让用户确认是否替换
     + ----------------------------------------------------------保存离开--------------------------------------------------------------
     + w ：保存
     + w! ：针对只读文件强制保存，但跟用户权限有关呀

     + q ：退出vim，未修改或修改并保存后的情况下退出

     + q! ：强制离开不保存文件

     + wq ：保存后退出

     + w fileName ：将当前内容保存为指定文件，相当于另存为
     + -------------------------------------------------------------vim配置----------------------------------------------------------------

     + set number ：显示行号

     + set nonumber ：不显示行号

3. 文件恢复

   + 在使用vim编辑文件时，vim会自动生成.filenam.swap的隐藏文件，在出现意外导致文件没有保存时，可通过这个文件进行恢复
   + vim被不正常中断时打开文件有如下操作提示，根据实际情况进行处理即可
     + O [open Read-Only] ：以只读方式打开，假如有另一个人正在编辑这个文件，可以采用这个方式
     + E [edit anyway] ：正常方式打开文件进行编辑，不会载入暂存文件内容，但有可能会导致两个用户互相改变对方文件的问题，不推荐此法
     + R [recover] ：加载暂存文件内容，恢复之前未保存的内容，但最后保存离开vim后，需要手动删除那个swap暂存文件
     + D [delete it] ：确定暂存文件无用，在打开文件前将暂存文件删除
     + Q [quit] ：离开vim，不进行任何操作
     + A [abort] ：通Q类似，也是离开vim

4. 块选择

5. 多文件编辑

6. 多窗口功能

7. vim环境设置与记录